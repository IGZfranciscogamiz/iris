/**
 * Copyright (c) 2012 Intelygenz <www.intelygenz.com>
 * @license http://directory.fsf.org/wiki/License:BSD_3Clause
 * @version 0.4.5
 * */
var iris={};
(function(){function w(){t&&F.debug&&window.console.debug(x,arguments)}function r(){t&&F.error&&window.console.error(x,arguments)}function Q(){if(!R)return iris.E("You must set the welcome screen using iris.screen.WelcomeScreen()"),!1;iris.event.Notify(iris.event.BEFORE_NAVIGATION);if(L)return L=!1;var a=y.split("/"),b=document.location.hash.split("/"),c="",d="",h,z=!1,g;if(""!==y)for(g=0;g<a.length;g++)if(""!==a[g]&&(c+=a[g]+"/",h=M(c),k.hasOwnProperty(h)&&!1===k[h].CanSleep()))return L=!0,document.location.hash=
y,!1;c="";if(a.length>b.length)for(g=0;g<a.length;g++)if(c+=a[g]+"/",b[g]&&(d+=b[g]+"/"),z||d!==c)z=!0,h=M(c),k[h].__Sleep__(),k[h].Hide();d=c="";z=!1;for(g=0;g<b.length;g++)if(d+=b[g]+"/",a[g]&&(c+=a[g]+"/"),z||d!==c){var z=!0,e=h=M(d),i=b[g];h={};for(var f=/([\.\w_\-]*)=([^&]*)/g,j=f.exec(i);j;)h[j[1]]=decodeURIComponent(j[2]),j=f.exec(i);N.hasOwnProperty(e)?(k.hasOwnProperty(e)||(i=e,f=S[i],A(f),j=new u,l[f](j),j.__Id__=i,j.__Element__={},j.__UIComponents__=[],j.__$Container__=N[i],j.__FileJs__=
f,j.Create(),j.Hide(),k[i]=j),e=k[e],i=e.$Get().parent().data("screen_context"),B.hasOwnProperty(i)&&(f=B[i],f.__Sleep__(),f.Hide()),e.__Awake__(h?h:{}),e.Show(),B[i]=e):r("Screen '"+e+"' must be registered with self.AddScreen() before go to")}y=d.replace(/\/$/,"")}function M(a){return a.replace(/\?[^\/]*/,"").replace(/\/$/,"")}function T(a){void 0!==a?O=a:(a=document.getElementsByTagName("base"),a=0<a.length?a[0].attributes.href.value:"/",O=document.location.protocol+"//"+document.location.host+
a);return O}function U(a,b,c,d){a={url:a,dataType:b,async:!1,cache:G,success:c,error:d};G&&void 0!==P&&(a.data="_="+P);$.ajax(a)}function A(a){if(!l.hasOwnProperty(a)){l[a]=!0;var b=0===a.indexOf("http")?a:T()+a;w("[iris.ui.Include]",b);if(-1<a.lastIndexOf(".css")){var c=document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;V.appendChild(c)}else{var d=-1<a.lastIndexOf(".html");U(b,d?"html":"text",function(b){H=a;if(d){var c=l,g=b.match(/@@[A-Za-z_\.]+@@/g);if(g){var e,f=g.length;
for(e=0;e<f;e++)b=b.replace(g[e],W(g[e].substring(2,g[e].length-2)))}c[a]=b}else c=document.createElement("script"),c.language="javascript",c.type="text/javascript",c.text=b,V.appendChild(c)},function(a){delete l[b];r(a.status,"Error loading file '"+b+"'")})}}}function I(a){if(void 0!==a)n=a;else{if(!n){n=m["environment-default"];for(var b in m.environment)if(-1<document.location.href.indexOf(b)){n=m.environment[b];break}n||(n="pro");x="["+n+"]"}return n}}function X(a){$.extend(C,a);return C}function Y(a){$.extend(D,
a);return D}function Z(a,b){var c=p[a];if(c)for(var d=0,h=c.length;d<h;d++)if(c[d]===b)return d;return-1}function aa(a,b){var c;if(-1<b.indexOf(".")){c=b.split(".");var d,h=c.length;for(d=0;d<h;d++)if(void 0!==a)a=a[c[d]];else break;c=a}else c=a[b];return c}function ba(a,b){w("[iris.lang.Load]",a,b);null===f&&(f=a);s.hasOwnProperty(a)||(s[a]={});$.extend(s[a],b)}function W(a){var b;s.hasOwnProperty(f)?(b=aa(s[f],a),void 0===b&&iris.W("Label '"+a+"' not found in Locale '"+f+"'",s[f]),"object"===typeof b&&
iris.W("Label '"+a+"' is an object but must be a property in Locale '"+f+"'",s[f])):iris.W("Locale '"+f+"' not loaded");return b?b:"??"+a+"??"}function ca(a){for(var b={},a=a.get(0).attributes,c,d=0,h=a.length;d<h;d++)c=a[d].name,0===c.indexOf("data-")&&(c=c.substr(5)),b[c]=a[d].value;return b}function da(a){for(var b=ea("currency"),c=Number(a),a=0<=c?b.formatPos:b.formatNeg,d=c%1,c=String(Math.abs(c-d)),d=String(Math.abs(d).toFixed(b.precision)),d=d.substr(2),h=0;h<Math.floor((c.length-(1+h))/3);h++)c=
c.substring(0,c.length-(4*h+3))+b.thousand+c.substring(c.length-(4*h+3));return a.replace("n",c+b.decimal+d)}function fa(a,b){b||(b=ea("dateFormat"));"object"!==typeof a&&(a=new Date(Number(a)));for(var c="",d=0,h=b.length;d<h;d++)c+=ha(b[d],a);return c}function ea(a){if(E.hasOwnProperty(f)){if(E[f].hasOwnProperty(a))return E[f][a];iris.E("Regional setting '"+a+"' not found for locale '"+f+"'")}else iris.E("Regional for locale '"+f+"' not found")}function v(a){return 10>a?"0"+a:a}function ha(a,b){var c=
E[f];switch(a){case "y":return String(b.getFullYear()).substring(2);case "Y":return b.getFullYear();case "m":return c=b.getMonth()+1,v(c);case "n":return b.getMonth()+1;case "M":return c.monthNames[b.getMonth()].substring(0,3);case "b":return c.monthNames[b.getMonth()].substring(0,3).toLowerCase();case "F":return c.monthNames[b.getMonth()];case "d":return c=b.getDate(),v(c);case "D":return c.dayNames[b.getDay()].substring(0,3);case "l":return c.dayNames[b.getDay()];case "s":return c=b.getSeconds(),
v(c);case "i":return c=b.getMinutes(),v(c);case "H":return c=b.getHours(),v(c);case "h":return c=b.getHours(),v(0===c%12?12:c%12);case "a":return 12<b.getHours()?"p.m.":"a.m.";case "A":return 12<b.getHours()?"PM":"AM";case "U":return Math.floor(0.001*b.getTime());default:return a}}var P,n=null,F={error:!0},x="",k={},S={},N={},B={},y="",C={},D={},f=null,m={},s={},p={},l={},ga={},O="",H,V=$("head").get(0),G=!0,t,L=!1,R=!1,E={"en-US":{dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
monthNames:"January February March April May June July August September October November December".split(" "),dateFormat:"m/d/Y h:i:s",currency:{formatPos:"n",formatNeg:"(n)",decimal:".",thousand:",",precision:2}},"es-ES":{dayNames:"Domingo Lunes Martes Mi\u00e9rcoles Jueves Viernes S\u00e1bado".split(" "),monthNames:"Enero Febrero Marzo Abril Mayo Junio Julio Agosto Septiembre Octubre Noviembre Diciembre".split(" "),dateFormat:"d/m/Y H:i:s",currency:{formatPos:"n",formatNeg:"-n",decimal:",",thousand:".",
precision:2}}},J=function(){this.__Setting__=null};J.prototype.Settings=function(a){return $.extend(this.__Setting__,a)};J.prototype.Setting=function(a,b){if(void 0===b)return this.__Setting__.hasOwnProperty(a)||iris.W("The setting ",a," is not in ",this.__Setting__,this),this.__Setting__[a];this.__Setting__[a]=b};var e=function(){this.TEMPLATE_APPEND="append";this.TEMPLATE_REPLACE="replace";this.TEMPLATE_PREPEND="prepend";this.__Element__=this.__FileTmpl__=this.__FileJs__=this.__IsSleeping__=this.__$Container__=
this.__UIComponents__=this.__Id__=this.__$Tmpl__=null};e.prototype=new J;e.prototype.__Sleep__=function(){for(var a=0,b=this.__UIComponents__.length;a<b;a++)this.__UIComponents__[a].__Sleep__();this.__IsSleeping__=!0;this.Sleep()};e.prototype.__Awake__=function(a){for(var b=0,c=this.__UIComponents__.length;b<c;b++)this.__UIComponents__[b].__Awake__();this.__IsSleeping__=!1;this.Awake(a)};e.prototype.__Destroy__=function(){this.__IsSleeping__||this.__Sleep__();for(var a=0,b=this.__UIComponents__.length;a<
b;a++)this.__UIComponents__[a].__Destroy__();this.__UIComponents__=null;this.Destroy()};e.prototype.__Template__=function(a,b,c){this.__FileTmpl__=a;if("undefined"===typeof a)return this.__$Tmpl__=this.__$Container__;iris.Include(a);if(b){for(var d=l[a],h=d,e,g,f=/##([0-9A-Za-z_\.]+)(?:\|(date|currency)(?:\(([^\)]+)\))*)?##/g,i=f.exec(d);i;){g=aa(b,i[1]);if(void 0!==g){if(e=i[2])switch(e){case "date":g=fa(g,i[3]);break;case "currency":g=da(g);break;default:iris.W("Unknow template format label '"+
e+"' in '"+a+"'")}}else iris.W("Template param '"+i[1]+"' in '"+a+"' not found",b);h=h.replace(i[0],g);i=f.exec(d)}b=h}else b=l[a];this.__$Tmpl__=b=$(b);1<b.size()&&iris.E("Template '"+a+"' must have only one root node");switch(c){case this.TEMPLATE_APPEND:this.__$Container__.append(b);break;case this.TEMPLATE_REPLACE:this.__$Container__.replaceWith(b);break;case this.TEMPLATE_PREPEND:this.__$Container__.prepend(b);break;default:iris.E("Unknown template mode '"+c+"'")}};e.prototype.__CheckTmpl__=
function(){null===this.__$Tmpl__&&iris.E("You must set a template using self.Template() in '"+this.__FileJs__+"'")};e.prototype.Show=function(){this.__CheckTmpl__();this.__$Tmpl__.show()};e.prototype.Hide=function(){this.__CheckTmpl__();this.__$Tmpl__.hide()};e.prototype.$Get=function(a){this.__CheckTmpl__();if(a){if(!this.__Element__.hasOwnProperty(a)){var b="[data-id="+a+"]",c=this.__$Tmpl__.filter(b),d=null;0<c.length?d=c:(b=this.__$Tmpl__.find(b),0<b.size()&&(d=b));if(null===d){iris.E("[data-id="+
a+"] not found in '"+this.__FileTmpl__+"' used by '"+this.__FileJs__+"'");return}if(1<d.size()){iris.E("[data-id="+a+"] must be unique in '"+this.__FileTmpl__+"' used by '"+this.__FileJs__+"'");return}this.__Element__[a]=d}return this.__Element__[a]}return this.__$Tmpl__};e.prototype.InstanceUI=function(a,b,c,d){a=this.$Get(a);if(1===a.size()){var h=a.data("id");A(b);var e=new K;l[b](e);e.__Id__=h;e.__Element__={};e.__$Container__=a;e.__UIComponents__=[];e.__Setting__={};e.__FileJs__=b;void 0!==d&&
(e.__TemplateMode__=d);c=void 0===c?{}:c;b=ca(a);$.extend(e.__Setting__,b,c);e.Create(b,c);return this.__UIComponents__[this.__UIComponents__.length]=e}};e.prototype.DestroyUI=function(a){for(var b=0,c=this.__UIComponents__.length;b<c;b++)if(this.__UIComponents__[b]===a){this.__UIComponents__.splice(b,1);a.__Destroy__();a.$Get().remove();break}};e.prototype.DestroyAllUIs=function(a){for(var a="string"===typeof a?"[data-id="+a+"]":a.selector,b,c=0,d=this.__UIComponents__.length;c<d;c++)b=this.__UIComponents__[c],
b.__$Container__.selector===a&&(this.__UIComponents__.splice(c--,1),d--,b.__Destroy__(),b.$Get().remove())};e.prototype.$Container=function(){return this.__$Container__};e.prototype.Create=function(){};e.prototype.Awake=function(){};e.prototype.CanSleep=function(){return!0};e.prototype.Sleep=function(){};e.prototype.Destroy=function(){};var q=function(){this.__Components__=null};q.prototype=new J;q.prototype.AddAll=function(a){for(var b=0,c=a.length;b<c;b++)this.Add(a[b])};q.prototype.Add=function(a){this.hasOwnProperty("UIAddOn")&&
this.UIAddOn(a);this.__Components__[this.__Components__.length]=a};q.prototype.Remove=function(a){for(var b,c=0,d=this.__Components__.length;c<d;c++)b=this.__Components__[c],b===a&&this.__Components__.splice(c,1)};q.prototype.Get=function(a){return this.__Components__[a]};q.prototype.Size=function(){return this.__Components__.length};q.prototype.Create=function(){};var K=function(){this.__TemplateMode__="replace"};K.prototype=new e;K.prototype.TemplateMode=function(a){this.__TemplateMode__=a};K.prototype.Template=
function(a,b){this.__Template__(a,b,this.__TemplateMode__)};var u=function(){};u.prototype=new e;u.prototype.Template=function(a,b){this.__Template__(a,b,this.TEMPLATE_APPEND)};u.prototype.AddScreen=function(a,b,c){var d=this.$Get(a);void 0===d.data("screen_context")&&d.data("screen_context",this.__Id__+"|"+a);S[b]=c;N[b]=d};iris.screen={};iris.event={};iris.config={};iris.ui={};iris.net={};iris.global={};iris.local={};iris.lang={};iris.util={};iris.config.Load=function(a){if(a){$.extend(m,a);X(m.global);
a=I();if(m.log)for(var b=m.log[a].split(","),c=0;c<b.length;c++)F[$.trim(b[c])]=!0;G=!0;if(m.hasOwnProperty("environments-nocache"))for(var b=m["environments-nocache"].split(","),c=0,d=b.length;c<d;c++)if(b[c]===a){G=!1;break}Y(m.local)}return m};iris.config.Env=I;iris.global.Load=X;iris.global.Data=function(a,b){if(a&&void 0!==b)C[a]=b;else return a?C[a]:C};iris.local.Load=Y;iris.local.Data=function(a,b){if(a&&void 0!==b)D[a][I()]=b;else return a?D[a][I()]:D};iris.lang.Load=ba;iris.lang.LoadFrom=
function(a,b,c){w("[iris.lang.LoadFrom]",a,b);U(b,"json",function(b){ba(a,b);w("[iris.lang.LoadFrom] loaded",b);c&&c.hasOwnProperty("success")&&c.success(a)},function(d){r(d.status,"Error loading lang file",b);c&&c.hasOwnProperty("error")&&c.error(a)})};iris.lang.Get=W;iris.lang.Locale=function(a){if(void 0!==a)f=a;else return f};iris.L=function(){t&&window.console.log&&window.console.log(x,arguments)};iris.D=w;iris.W=function(){t&&F.warning&&window.console.warn(x,arguments)};iris.E=r;iris.event.BEFORE_NAVIGATION=
"iris_before_navigation";iris.event.Subscribe=function(a,b){p[a]||(p[a]=[]);var c=Z(a,b);-1===c&&(c=p[a].length);p[a][c]=b};iris.event.Notify=function(a,b){if(p[a])for(var c=p[a],d=0,e=c.length;d<e;d++)c[d](b)};iris.event.Remove=function(a,b){var c=Z(a,b);-1!==c&&p[a].splice(c,1)};iris.net.BaseUri=T;iris.net.Ajax=function(a){return $.ajax(a)};iris.net.CacheVersion=function(a){P=a};iris.Screen=function(a){a.prototype=new u;l[H]=a};iris.UI=function(a){l[H]=a};iris.screen.WelcomeScreen=function(a){A(a);
var b=new u;l[a](b);b.__Id__="welcome-screen";b.__Element__={};b.__UIComponents__=[];b.__$Container__=$(document.body);b.__FileJs__=a;b.Create();b.__Awake__();b.Show();R=!0;"onhashchange"in window?(document.location.hash&&Q(),$(window).bind("hashchange",Q)):r("The browser doesn't support the hashchange event")};iris.screen.Destroy=function(a){if(k.hasOwnProperty(a)){var b=k[a].$Get().parent().data("screen_context");B[b]===k[a]&&delete B[b];k[a].__Destroy__();k[a].$Get().remove();delete k[a]}else iris.W('Error removing the screen "'+
a+'", path not found.')};iris.ui.JqToHash=ca;iris.ui.HashToJq=function(a,b,c){var d=b.get(0);if(c)for(var e,f=0,g=c.length;f<g;f++)(e=a[c[f]])&&d.setAttribute(c[f],e);else for(e in a)a.hasOwnProperty(e)&&d.setAttribute(e,a[e]);return b};iris.Include=function(){for(var a=0,b=arguments.length;a<b;a++)A(arguments[a])};iris.util.DateFormat=fa;iris.util.Currency=da;iris.util.Deserialize=function(a,b){var c,d,e,f;for(f in b)if(b.hasOwnProperty(f)&&(c=a.find('[name="'+f+'"]'),0<c.length))switch(d=c[0].tagName.toLowerCase(),
e=b[f],d){case "select":case "textarea":$(c).val(e);break;case "input":switch(d){case "checkbox":e&&c.attr("checked","checked");break;case "radio":c.filter('[value="'+e+'"]').attr("checked","checked");break;default:c.val(e)}}};iris.util.Serialize=function(a){var b={};$.map(a.serializeArray(),function(a){b[a.name]=a.value});return b};iris.Goto=function(a){y=document.location.hash;document.location.hash=a};iris.AddOn=function(a){ga[H]=a};iris.ApplyAddOn=function(a,b,c){A(a);var d=new q;d.__Components__=
[];d.__Setting__={};ga[a](d);d.Settings(c);d.AddAll(b);d.Create();return d};iris.Regional=function(a,b){!b.hasOwnProperty("dayNames")||!b.hasOwnProperty("monthNames")||!b.hasOwnProperty("dateFormat")||!b.hasOwnProperty("currency")||!b.currency.hasOwnProperty("formatPos")||!b.currency.hasOwnProperty("formatNeg")||!b.currency.hasOwnProperty("decimal")||!b.currency.hasOwnProperty("thousand")||!b.currency.hasOwnProperty("precision")?iris.E("Regional '"+a+"' has invalid format ",b):E[a]=b};"undefined"===
typeof jQuery?r("jQuery 1.5+ previous load required"):1.5>$().jquery&&r("jQuery "+$().jquery+" currently loaded, jQuery 1.5+ required");t=window.console&&window.console.debug&&window.console.warn&&window.console.error;!t&&(window.console&&window.console.log)&&window.console.log("advanced console debugging is not supported in this browser")})();