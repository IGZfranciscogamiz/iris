/*! Iris - v0.5.0 - 2012-11-17
* https://github.com/iris-js/iris.git
* Copyright (c) 2012 Iris; Licensed New-BSD */
var iris={event:{},config:{},net:{},global:{},local:{},lang:{},util:{}};(function(e){function C(){typeof jQuery=="undefined"?M("jQuery "+n+"+ previous load required"):e().jquery<n&&M("jQuery "+e().jquery+" currently loaded, jQuery "+n+"+ required"),x=window.console&&window.console.debug&&window.console.warn&&window.console.error,!x&&window.console&&window.console.log&&window.console.log("advanced console debugging is not supported in this browser")}function k(e){return i[e]}function L(){x&&window.console.log&&window.console.log(s,arguments)}function A(){x&&k("debug")&&window.console.debug(s,arguments)}function O(){x&&k("warning")&&window.console.warn(s,arguments)}function M(){x&&k("error")&&window.console.error(s,arguments)}function _(e){l=document.location.hash,document.location.hash=e}function D(){if(!N)return iris.E("You must set the welcome screen using iris.screen.WelcomeScreen()"),!1;iris.event.Notify(iris.event.BEFORE_NAVIGATION);if(T)return T=!1,!1;var e=l.split("/"),t=document.location.hash.split("/"),n="",r="",i,s=!1,u;if(l!=="")for(u=0;u<e.length;u++)if(e[u]!==""){n+=e[u]+"/",i=P(n);if(o.hasOwnProperty(i)&&o[i].CanSleep()===!1)return T=!0,document.location.hash=l,!1}n="";if(e.length>t.length)for(u=0;u<e.length;u++){n+=e[u]+"/",t[u]&&(r+=t[u]+"/");if(s||r!==n)s=!0,i=P(n),o[i].__Sleep__(),o[i].Hide()}n="",r="",s=!1;for(u=0;u<t.length;u++){r+=t[u]+"/",e[u]&&(n+=e[u]+"/");if(s||r!==n)s=!0,i=P(r),dt(i,B(t[u]))}l=H(r)}function P(e){return H(e.replace(/\?[^\/]*/,""))}function H(e){return e.replace(/\/$/,"")}function B(e){var t={},n=/([\.\w_\-]*)=([^&]*)/g,r=n.exec(e);while(r)t[r[1]]=decodeURIComponent(r[2]),r=n.exec(e);return t}function j(e){if(e!==undefined)b=e;else{var t=document.getElementsByTagName("base");t=t.length>0?t[0].attributes.href.value:"/",b=document.location.protocol+"//"+document.location.host+t}return b}function F(t){return e.ajax(t)}function I(n,r,i,s){var o={url:n,dataType:r,async:!1,cache:S,success:i,error:s};S&&t!==undefined&&(o.data="_="+t),e.ajax(o)}function q(e){t=e}function R(){for(var e=0,t=arguments.length;e<t;e++)U(arguments[e])}function U(e){if(!g.hasOwnProperty(e)){g[e]=!0;var t=e.indexOf("http")===0?e:j()+e;A("[iris.ui.Include]",t);if(e.lastIndexOf(".css")>-1){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=t,E.appendChild(n)}else{var r=e.lastIndexOf(".html")>-1;I(t,r?"html":"text",function(t){w=e;if(r)g[e]=rt(t);else{var n=document.createElement("script");n.language="javascript",n.type="text/javascript",n.text=t,E.appendChild(n)}},function(e){delete g[t],M(e.status,"Error loading file '"+t+"'")})}}}function z(t){if(t){e.extend(d,t),X(d.global);var n=W();if(d.log){var r=d.log[n],s=r.split(",");for(var o=0;o<s.length;o++)i[e.trim(s[o])]=!0}S=!0;if(d.hasOwnProperty("environments-nocache")){var u=d["environments-nocache"].split(",");for(var a=0,f=u.length;a<f;a++)if(u[a]===n){S=!1;break}}$(d.local)}return d}function W(e){if(e===undefined){if(!r){r=d["environment-default"];for(var t in d.environment)if(document.location.href.indexOf(t)>-1){r=d.environment[t];break}r||(r="pro"),s="["+r+"]"}return r}r=e}function X(t){return e.extend(c,t),c}function V(e,t){if(!e||t===undefined)return e?c[e]:c;c[e]=t}function $(t){return e.extend(h,t),h}function J(e,t){if(!e||t===undefined)return e?h[e][W()]:h;h[e][W()]=t}function K(e,t){var n=m[e];if(n)for(var r=0,i=n.length;r<i;r++)if(n[r]===t)return r;return-1}function Q(e,t){m[e]||(m[e]=[]);var n=K(e,t);n===-1&&(n=m[e].length),m[e][n]=t}function G(e,t){var n=K(e,t);n!==-1&&m[e].splice(n,1)}function Y(e,t){if(m[e]){var n=m[e];for(var r=0,i=n.length;r<i;r++)n[r](t)}}function Z(e,t){var n;if(t.indexOf(".")>-1){var r=t.split("."),i,s=r.length;for(i=0;i<s;i++){if(e===undefined)break;e=e[r[i]]}n=e}else n=e[t];return n}function et(t,n){A("[iris.lang.Load]",t,n),p===null&&(p=t),v.hasOwnProperty(t)||(v[t]={}),e.extend(v[t],n)}function tt(e){var t;return v.hasOwnProperty(p)?(t=Z(v[p],e),t===undefined&&iris.W("Label '"+e+"' not found in Locale '"+p+"'",v[p]),typeof t=="object"&&iris.W("Label '"+e+"' is an object but must be a property in Locale '"+p+"'",v[p])):iris.W("Locale '"+p+"' not loaded"),t?t:"??"+e+"??"}function nt(e){if(e===undefined)return p;p=e}function rt(e){var t=e,n=t.match(/@@[A-Za-z_\.]+@@/g);if(n){var r,i=n.length;for(r=0;r<i;r++)t=t.replace(n[r],tt(n[r].substring(2,n[r].length-2)))}return t}function it(e,t,n){A("[iris.lang.LoadFrom]",e,t),I(t,"json",function(t){et(e,t),A("[iris.lang.LoadFrom] loaded",t),n&&n.hasOwnProperty("success")&&n.success(e)},function(r){M(r.status,"Error loading lang file",t),n&&n.hasOwnProperty("error")&&n.error(e)})}function st(e,t,n){var r=t.get(0);if(n){var i;for(var s=0,o=n.length;s<o;s++)i=e[n[s]],i&&r.setAttribute(n[s],i)}else for(var u in e)e.hasOwnProperty(u)&&r.setAttribute(u,e[u]);return t}function ot(e){var t={},n=e.get(0).attributes,r;for(var i=0,s=n.length;i<s;i++)r=n[i].name,r.indexOf("data-")===0&&(r=r.substr(5)),t[r]=n[i].value;return t}function ut(e,t,n){U(e);var r=new Ct;return r.__Components__=[],r.__Setting__={},y[e](r),r.Settings(n),r.AddAll(t),r.Create(),r}function at(e){y[w]=e}function ft(e){g[w]=e}function lt(t,n,r,i,s){U(r);var o=new kt;g[r](o),o.__Id__=n,o.__Element__={},o.__$Container__=t,o.__UIComponents__=[],o.__Setting__={},o.__FileJs__=r,s!==undefined&&(o.__TemplateMode__=s),i=i===undefined?{}:i;var u=ot(t);return e.extend(o.__Setting__,u,i),o.Create(u,i),o}function ct(e){e.prototype=new Lt,g[w]=e}function ht(e){var t=u[e];U(t);var n=new Lt;g[t](n),n.__Id__=e,n.__Element__={},n.__UIComponents__=[],n.__$Container__=a[e],n.__FileJs__=t,n.Create(),n.Hide(),o[e]=n}function pt(e){if(o.hasOwnProperty(e)){var t=o[e].$Get().parent().data("screen_context");f[t]===o[e]&&delete f[t],o[e].__Destroy__(),o[e].$Get().remove(),delete o[e]}else iris.W('Error removing the screen "'+e+'", path not found.')}function dt(e,t){if(!a.hasOwnProperty(e))M("Screen '"+e+"' must be registered with self.AddScreen() before go to");else{o.hasOwnProperty(e)||ht(e);var n=o[e],r=n.$Get().parent().data("screen_context");if(f.hasOwnProperty(r)){var i=f[r];i.__Sleep__(),i.Hide()}n.__Awake__(t?t:{}),n.Show(),f[r]=n}}function vt(t){U(t);var n=new Lt;g[t](n),n.__Id__="welcome-screen",n.__Element__={},n.__UIComponents__=[],n.__$Container__=e(document.body),n.__FileJs__=t,n.Create(),n.__Awake__(),n.Show(),N=!0,"onhashchange"in window?(document.location.hash&&D(),e(window).bind("hashchange",D)):M("The browser doesn't support the hashchange event")}function mt(e,t,n){var r=e,i,s,o=/##([0-9A-Za-z_\.]+)(?:\|(date|currency)(?:\(([^\)]+)\))*)?##/g,u=o.exec(e);while(u){s=Z(t,u[1]);if(s!==undefined){i=u[2];if(i)switch(i){case"date":s=yt(s,u[3]);break;case"currency":s=gt(s);break;default:iris.W("Unknow template format label '"+i+"' in '"+n+"'")}}else iris.W("Template param '"+u[1]+"' in '"+n+"' not found",t);r=r.replace(u[0],s),u=o.exec(e)}return r}function gt(e){var t=bt("currency"),n=Number(e),r=n>=0?t.formatPos:t.formatNeg,i=n%1,s=String(Math.abs(n-i));i=String(Math.abs(i).toFixed(t.precision)),i=i.substr(2);for(var o=0;o<Math.floor((s.length-(1+o))/3);o++)s=s.substring(0,s.length-(4*o+3))+t.thousand+s.substring(s.length-(4*o+3));return r.replace("n",s+t.decimal+i)}function yt(e,t){t||(t=bt("dateFormat")),typeof e!="object"&&(e=new Date(Number(e)));var n="";for(var r=0,i=t.length;r<i;r++)n+=Et(t[r],e);return n}function bt(e){if(St.hasOwnProperty(p)){if(St[p].hasOwnProperty(e))return St[p][e];iris.E("Regional setting '"+e+"' not found for locale '"+p+"'")}else iris.E("Regional for locale '"+p+"' not found")}function wt(e){return e<10?"0"+e:e}function Et(e,t){var n=St[p];switch(e){case"y":return String(t.getFullYear()).substring(2);case"Y":return t.getFullYear();case"m":var r=t.getMonth()+1;return wt(r);case"n":return t.getMonth()+1;case"M":return n.monthNames[t.getMonth()].substring(0,3);case"b":return n.monthNames[t.getMonth()].substring(0,3).toLowerCase();case"F":return n.monthNames[t.getMonth()];case"d":var i=t.getDate();return wt(i);case"D":return n.dayNames[t.getDay()].substring(0,3);case"l":return n.dayNames[t.getDay()];case"s":var s=t.getSeconds();return wt(s);case"i":var o=t.getMinutes();return wt(o);case"H":var u=t.getHours();return wt(u);case"h":var a=t.getHours();return a=a%12===0?12:a%12,wt(a);case"a":return t.getHours()>12?"p.m.":"a.m.";case"A":return t.getHours()>12?"PM":"AM";case"U":return Math.floor(t.getTime()*.001);default:return e}}function xt(e,t){!t.hasOwnProperty("dayNames")||!t.hasOwnProperty("monthNames")||!t.hasOwnProperty("dateFormat")||!t.hasOwnProperty("currency")||!t.currency.hasOwnProperty("formatPos")||!t.currency.hasOwnProperty("formatNeg")||!t.currency.hasOwnProperty("decimal")||!t.currency.hasOwnProperty("thousand")||!t.currency.hasOwnProperty("precision")?iris.E("Regional '"+e+"' has invalid format ",t):St[e]=t}function At(t,n){var r,i,s;for(var o in n)if(n.hasOwnProperty(o)){r=t.find('[name="'+o+'"]');if(r.length>0){i=r[0].tagName.toLowerCase(),s=n[o];switch(i){case"select":case"textarea":e(r).val(s);break;case"input":switch(i){case"checkbox":s&&r.attr("checked","checked");break;case"radio":r.filter('[value="'+s+'"]').attr("checked","checked");break;default:r.val(s)}}}}}function Ot(t){var n={};return e.map(t.serializeArray(),function(e){n[e.name]=e.value}),n}var t,n=1.5,r=null,i={error:!0},s="",o={},u={},a={},f={},l="",c={},h={},p=null,d={},v={},m={},g={},y={},b="",w,E=e("head").get(0),S=!0,x,T=!1,N=!1,St={"en-US":{dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],dateFormat:"m/d/Y h:i:s",currency:{formatPos:"n",formatNeg:"(n)",decimal:".",thousand:",",precision:2}},"es-ES":{dayNames:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dateFormat:"d/m/Y H:i:s",currency:{formatPos:"n",formatNeg:"-n",decimal:",",thousand:".",precision:2}}},Tt=function(){this.__Setting__=null};Tt.prototype.Settings=function(t){return e.extend(this.__Setting__,t)},Tt.prototype.Setting=function(e,t){if(t===undefined)return this.__Setting__.hasOwnProperty(e)||iris.W("The setting ",e," is not in ",this.__Setting__,this),this.__Setting__[e];this.__Setting__[e]=t};var Nt=function(){this.TEMPLATE_APPEND="append",this.TEMPLATE_REPLACE="replace",this.TEMPLATE_PREPEND="prepend",this.__$Tmpl__=null,this.__Id__=null,this.__UIComponents__=null,this.__$Container__=null,this.__IsSleeping__=null,this.__FileJs__=null,this.__FileTmpl__=null,this.__Element__=null};Nt.prototype=new Tt,Nt.prototype.__Sleep__=function(){for(var e=0,t=this.__UIComponents__.length;e<t;e++)this.__UIComponents__[e].__Sleep__();this.__IsSleeping__=!0,this.Sleep()},Nt.prototype.__Awake__=function(e){for(var t=0,n=this.__UIComponents__.length;t<n;t++)this.__UIComponents__[t].__Awake__();this.__IsSleeping__=!1,this.Awake(e)},Nt.prototype.__Destroy__=function(){this.__IsSleeping__||this.__Sleep__();for(var e=0,t=this.__UIComponents__.length;e<t;e++)this.__UIComponents__[e].__Destroy__();this.__UIComponents__=null,this.Destroy()},Nt.prototype.__Template__=function(t,n,r){this.__FileTmpl__=t;if(typeof t=="undefined")return this.__$Tmpl__=this.__$Container__,this.__$Tmpl__;iris.Include(t);var i=n?mt(g[t],n,t):g[t],s=e(i);this.__$Tmpl__=s,s.size()>1&&iris.E("Template '"+t+"' must have only one root node");switch(r){case this.TEMPLATE_APPEND:this.__$Container__.append(s);break;case this.TEMPLATE_REPLACE:this.__$Container__.replaceWith(s);break;case this.TEMPLATE_PREPEND:this.__$Container__.prepend(s);break;default:iris.E("Unknown template mode '"+r+"'")}},Nt.prototype.__CheckTmpl__=function(){if(this.__$Tmpl__===null)return iris.E("You must set a template using self.Template() in '"+this.__FileJs__+"'"),undefined},Nt.prototype.Show=function(){this.__CheckTmpl__(),this.__$Tmpl__.show()},Nt.prototype.Hide=function(){this.__CheckTmpl__(),this.__$Tmpl__.hide()},Nt.prototype.$Get=function(e){this.__CheckTmpl__();if(e){if(!this.__Element__.hasOwnProperty(e)){var t="[data-id="+e+"]",n=this.__$Tmpl__.filter(t),r=null;if(n.length>0)r=n;else{var i=this.__$Tmpl__.find(t);i.size()>0&&(r=i)}if(r===null)return iris.E("[data-id="+e+"] not found in '"+this.__FileTmpl__+"' used by '"+this.__FileJs__+"'"),undefined;if(r.size()>1)return iris.E("[data-id="+e+"] must be unique in '"+this.__FileTmpl__+"' used by '"+this.__FileJs__+"'"),undefined;this.__Element__[e]=r}return this.__Element__[e]}return this.__$Tmpl__},Nt.prototype.InstanceUI=function(e,t,n,r){var i=this.$Get(e);if(i.size()===1){var s=lt(i,i.data("id"),t,n,r);return this.__UIComponents__[this.__UIComponents__.length]=s,s}},Nt.prototype.DestroyUI=function(e){for(var t=0,n=this.__UIComponents__.length;t<n;t++)if(this.__UIComponents__[t]===e){this.__UIComponents__.splice(t,1),e.__Destroy__(),e.$Get().remove();break}},Nt.prototype.DestroyAllUIs=function(e){var t=typeof e=="string"?"[data-id="+e+"]":e.selector,n;for(var r=0,i=this.__UIComponents__.length;r<i;r++)n=this.__UIComponents__[r],n.__$Container__.selector===t&&(this.__UIComponents__.splice(r--,1),i--,n.__Destroy__(),n.$Get().remove())},Nt.prototype.$Container=function(){return this.__$Container__},Nt.prototype.Create=function(){},Nt.prototype.Awake=function(){},Nt.prototype.CanSleep=function(){return!0},Nt.prototype.Sleep=function(){},Nt.prototype.Destroy=function(){};var Ct=function(){this.__Components__=null};Ct.prototype=new Tt,Ct.prototype.AddAll=function(e){for(var t=0,n=e.length;t<n;t++)this.Add(e[t])},Ct.prototype.Add=function(e){this.hasOwnProperty("UIAddOn")&&this.UIAddOn(e),this.__Components__[this.__Components__.length]=e},Ct.prototype.Remove=function(e){var t;for(var n=0,r=this.__Components__.length;n<r;n++)t=this.__Components__[n],t===e&&this.__Components__.splice(n,1)},Ct.prototype.Get=function(e){return this.__Components__[e]},Ct.prototype.Size=function(){return this.__Components__.length},Ct.prototype.Create=function(){};var kt=function(){this.__TemplateMode__="replace"};kt.prototype=new Nt,kt.prototype.TemplateMode=function(e){this.__TemplateMode__=e},kt.prototype.Template=function(e,t){this.__Template__(e,t,this.__TemplateMode__)};var Lt=function(){};Lt.prototype=new Nt,Lt.prototype.Template=function(e,t){this.__Template__(e,t,this.TEMPLATE_APPEND)},Lt.prototype.AddScreen=function(t,n,r){var i=this.$Get(t);i.data("screen_context")===undefined&&i.data("screen_context",this.__Id__+"|"+t),u[n]=r,a[n]=i},iris.screen={},iris.event={},iris.config={},iris.ui={},iris.net={},iris.global={},iris.local={},iris.lang={},iris.util={},iris.config.Load=z,iris.config.Env=W,iris.global.Load=X,iris.global.Data=V,iris.local.Load=$,iris.local.Data=J,iris.lang.Load=et,iris.lang.LoadFrom=it,iris.lang.Get=tt,iris.lang.Locale=nt,iris.L=L,iris.D=A,iris.W=O,iris.E=M,iris.event.BEFORE_NAVIGATION="iris_before_navigation",iris.event.Subscribe=Q,iris.event.Notify=Y,iris.event.Remove=G,iris.net.BaseUri=j,iris.net.Ajax=F,iris.net.CacheVersion=q,iris.Screen=ct,iris.UI=ft,iris.screen.WelcomeScreen=vt,iris.screen.Destroy=pt,iris.ui.JqToHash=ot,iris.ui.HashToJq=st,iris.Include=R,iris.util.DateFormat=yt,iris.util.Currency=gt,iris.util.Deserialize=At,iris.util.Serialize=Ot,iris.Goto=_,iris.AddOn=at,iris.ApplyAddOn=ut,iris.Regional=xt,C()})(jQuery);