/**
 * Copyright (c) 2012 Intelygenz <www.intelygenz.com>
 * @license http://directory.fsf.org/wiki/License:BSD_3Clause
 * @version 0.4.5
 * */
var iris=function(){function v(){t&&D.debug&&window.console.debug(w,arguments)}function r(){t&&D.error&&window.console.error(w,arguments)}function N(){if(!O)return iris.E("You must set the welcome screen using iris.screen.WelcomeScreen()"),!1;iris.event.Notify(iris.event.BEFORE_NAVIGATION);if(H)return H=!1;var a=x.split("/"),b=document.location.hash.split("/"),c="",d="",f,e=!1,g;if(""!==x)for(g=0;g<a.length;g++)if(""!==a[g]&&(c+=a[g]+"/",f=I(c),i.hasOwnProperty(f)&&!1===i[f].CanSleep()))return H=
!0,document.location.hash=x,!1;c="";if(a.length>b.length)for(g=0;g<a.length;g++)if(c+=a[g]+"/",b[g]&&(d+=b[g]+"/"),e||d!==c)e=!0,f=I(c),i[f].__Sleep__(),i[f].Hide();d=c="";e=!1;for(g=0;g<b.length;g++)if(d+=b[g]+"/",a[g]&&(c+=a[g]+"/"),e||d!==c){var e=!0,n=f=I(d),j=b[g];f={};for(var h=/([\.\w_\-]*)=([^&]*)/g,k=h.exec(j);k;)f[k[1]]=decodeURIComponent(k[2]),k=h.exec(j);J.hasOwnProperty(n)?(i.hasOwnProperty(n)||(j=n,h=P[j],y(h),k=K(),k.prototype=l[h](k),k.__Id__=j,k.__UIComponents__=[],k.__$Container__=
J[j],k.__FileJs__=h,k.Create(),k.Hide(),i[j]=k),n=i[n],j=n.$Get().parent().data("screen_context"),z.hasOwnProperty(j)&&(h=z[j],h.__Sleep__(),h.Hide()),n.__Awake__(f?f:{}),n.Show(),z[j]=n):r("Screen '"+n+"' must be registered with self.AddScreen() before go to")}x=d.replace(/\/$/,"")}function I(a){return a.replace(/\?[^\/]*/,"").replace(/\/$/,"")}function Q(a){void 0!==a?L=a:(a=document.getElementsByTagName("base"),a=0<a.length?a[0].attributes.href.value:"/",L=document.location.protocol+"//"+document.location.host+
a);return L}function R(a,b,c,d){a={url:a,dataType:b,async:!1,cache:E,success:c,error:d};E&&void 0!==M&&(a.data="_="+M);$.ajax(a)}function y(a){if(!l.hasOwnProperty(a)){l[a]=!0;var b=0===a.indexOf("http")?a:Q()+a;v("[iris.ui.Include]",b);if(-1<a.lastIndexOf(".css")){var c=document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;S.appendChild(c)}else{var d=-1<a.lastIndexOf(".html");R(b,d?"html":"text",function(b){F=a;if(d){var c=l,g=b.match(/@@[A-Za-z_\.]+@@/g);if(g){var e,h=g.length;
for(e=0;e<h;e++)b=b.replace(g[e],T(g[e].substring(2,g[e].length-2)))}c[a]=b}else c=document.createElement("script"),c.language="javascript",c.type="text/javascript",c.text=b,S.appendChild(c)},function(a){delete l[b];r(a.status,"Error loading file '"+b+"'")})}}}function G(a){if(void 0!==a)p=a;else{if(!p){p=m["environment-default"];for(var b in m.environment)if(-1<document.location.href.indexOf(b)){p=m.environment[b];break}p||(p="pro");w="["+p+"]"}return p}}function U(a){$.extend(A,a);return A}function V(a){$.extend(B,
a);return B}function W(a,b){var c=q[a];if(c)for(var d=0,f=c.length;d<f;d++)if(c[d]===b)return d;return-1}function X(a,b){var c;if(-1<b.indexOf(".")){c=b.split(".");var d,f=c.length;for(d=0;d<f;d++)if(void 0!==a)a=a[c[d]];else break;c=a}else c=a[b];return c}function Y(a,b){v("[iris.lang.Load]",a,b);null===h&&(h=a);s.hasOwnProperty(a)||(s[a]={});$.extend(s[a],b)}function T(a){var b;s.hasOwnProperty(h)?(b=X(s[h],a),void 0===b&&iris.W("Label '"+a+"' not found in Locale '"+h+"'",s[h]),"object"===typeof b&&
iris.W("Label '"+a+"' is an object but must be a property in Locale '"+h+"'",s[h])):iris.W("Locale '"+h+"' not loaded");return b?b:"??"+a+"??"}function Z(a){for(var b={},a=a.get(0).attributes,c,d=0,f=a.length;d<f;d++)c=a[d].name,0===c.indexOf("data-")&&(c=c.substr(5)),b[c]=a[d].value;return b}function aa(a){for(var b=ba("currency"),c=Number(a),a=0<=c?b.formatPos:b.formatNeg,d=c%1,c=String(Math.abs(c-d)),d=String(Math.abs(d).toFixed(b.precision)),d=d.substr(2),f=0;f<Math.floor((c.length-(1+f))/3);f++)c=
c.substring(0,c.length-(4*f+3))+b.thousand+c.substring(c.length-(4*f+3));return a.replace("n",c+b.decimal+d)}function ca(a,b){b||(b=ba("dateFormat"));"object"!==typeof a&&(a=new Date(Number(a)));for(var c="",d=0,f=b.length;d<f;d++)c+=ga(b[d],a);return c}function ba(a){if(C.hasOwnProperty(h)){if(C[h].hasOwnProperty(a))return C[h][a];iris.E("Regional setting '"+a+"' not found for locale '"+h+"'")}else iris.E("Regional for locale '"+h+"' not found")}function u(a){return 10>a?"0"+a:a}function ga(a,b){var c=
C[h];switch(a){case "y":return String(b.getFullYear()).substring(2);case "Y":return b.getFullYear();case "m":return c=b.getMonth()+1,u(c);case "n":return b.getMonth()+1;case "M":return c.monthNames[b.getMonth()].substring(0,3);case "b":return c.monthNames[b.getMonth()].substring(0,3).toLowerCase();case "F":return c.monthNames[b.getMonth()];case "d":return c=b.getDate(),u(c);case "D":return c.dayNames[b.getDay()].substring(0,3);case "l":return c.dayNames[b.getDay()];case "s":return c=b.getSeconds(),
u(c);case "i":return c=b.getMinutes(),u(c);case "H":return c=b.getHours(),u(c);case "h":return c=b.getHours(),u(0===c%12?12:c%12);case "a":return 12<b.getHours()?"p.m.":"a.m.";case "A":return 12<b.getHours()?"PM":"AM";case "U":return Math.floor(0.001*b.getTime());default:return a}}function da(){var a={__Setting__:null,Settings:function(b){return $.extend(a.__Setting__,b)},Setting:function(b,c){if(void 0===c)return a.__Setting__.hasOwnProperty(b)||iris.W("The setting ",b," is not in ",a.__Setting__,
a),a.__Setting__[b];a.__Setting__[b]=c}};return a}function ea(){var a=da();a.TEMPLATE_APPEND="append";a.TEMPLATE_REPLACE="replace";a.TEMPLATE_PREPEND="prepend";a.__$Tmpl__=null;a.__Id__=null;a.__UIComponents__=null;a.__$Container__=null;a.__IsSleeping__=null;a.__FileJs__=null;a.__FileTmpl__=null;a.__Sleep__=function(){for(var b=0,c=a.__UIComponents__.length;b<c;b++)a.__UIComponents__[b].__Sleep__();a.__IsSleeping__=!0;a.Sleep()};a.__Awake__=function(b){for(var c=0,d=a.__UIComponents__.length;c<d;c++)a.__UIComponents__[c].__Awake__();
a.__IsSleeping__=!1;a.Awake(b)};a.__Destroy__=function(){a.__IsSleeping__||a.__Sleep__();for(var b=0,c=a.__UIComponents__.length;b<c;b++)a.__UIComponents__[b].__Destroy__();a.__UIComponents__=null;a.Destroy()};a.__Template__=function(b,c,d){a.__FileTmpl__=b;if("undefined"===typeof b)return a.__$Tmpl__=a.__$Container__,a.__$Tmpl__;iris.Include(b);if(c){for(var f=l[b],e=f,g,h,j=/##([0-9A-Za-z_\.]+)(?:\|(date|currency)(?:\(([^\)]+)\))*)?##/g,i=j.exec(f);i;){h=X(c,i[1]);if(void 0!==h){if(g=i[2])switch(g){case "date":h=
ca(h,i[3]);break;case "currency":h=aa(h);break;default:iris.W("Unknow template format label '"+g+"' in '"+b+"'")}}else iris.W("Template param '"+i[1]+"' in '"+b+"' not found",c);e=e.replace(i[0],h);i=j.exec(f)}c=e}else c=l[b];c=$(c);a.__$Tmpl__=c;1<c.size()&&iris.E("Template '"+b+"' must have only one root node");switch(d){case a.TEMPLATE_APPEND:a.__$Container__.append(c);break;case a.TEMPLATE_REPLACE:a.__$Container__.replaceWith(c);break;case a.TEMPLATE_PREPEND:a.__$Container__.prepend(c);break;
default:iris.E("Unknown template mode '"+d+"'")}};a.__CheckTmpl__=function(){null===a.__$Tmpl__&&iris.E("You must set a template using self.Template() in '"+a.__FileJs__+"'")};a.Show=function(){a.__CheckTmpl__();a.__$Tmpl__.show()};a.Hide=function(){a.__CheckTmpl__();a.__$Tmpl__.hide()};a.$Get=function(b){a.__CheckTmpl__();if(b){var c="[data-id="+b+"]",d=a.__$Tmpl__.filter(c),f=null;0<d.length?f=d:(c=a.__$Tmpl__.find(c),0<c.size()&&(f=c));if(null===f){iris.E("[data-id="+b+"] not found in '"+a.__FileTmpl__+
"' used by '"+a.__FileJs__+"'");return}if(1<f.size()){iris.E("[data-id="+b+"] must be unique in '"+a.__FileTmpl__+"' used by '"+a.__FileJs__+"'");return}return f}return a.__$Tmpl__};a.InstanceUI=function(b,c,d,f){b=a.$Get(b);if(1===b.size()){var e=b.data("id");y(c);var g=ea();g.__TemplateMode__=g.TEMPLATE_REPLACE;g.TemplateMode=function(a){g.__TemplateMode__=a};g.Template=function(a,b){g.__Template__(a,b,g.__TemplateMode__)};g.__Id__=e;g.__$Container__=b;g.__UIComponents__=[];g.__Setting__={};g.__FileJs__=
c;void 0!==f&&(g.__TemplateMode__=f);g.prototype=l[c](g);d=void 0===d?{}:d;c=Z(b);$.extend(g.__Setting__,c,d);g.Create(c,d);return a.__UIComponents__[a.__UIComponents__.length]=g}};a.DestroyUI=function(b){for(var c=0,d=a.__UIComponents__.length;c<d;c++)if(a.__UIComponents__[c]===b){a.__UIComponents__.splice(c,1);b.__Destroy__();b.$Get().remove();break}};a.DestroyAllUIs=function(b){for(var b="string"===typeof b?"[data-id="+b+"]":b.selector,c,d=0,f=a.__UIComponents__.length;d<f;d++)c=a.__UIComponents__[d],
c.__$Container__.selector===b&&(a.__UIComponents__.splice(d--,1),f--,c.__Destroy__(),c.$Get().remove())};a.$Container=function(){return a.__$Container__};a.Create=function(){};a.Awake=function(){};a.CanSleep=function(){return!0};a.Sleep=function(){};a.Destroy=function(){};return a}function K(){var a=ea();a.Template=function(b,c){a.__Template__(b,c,a.TEMPLATE_APPEND)};a.AddScreen=function(b,c,d){var f=a.$Get(b);void 0===f.data("screen_context")&&f.data("screen_context",a.__Id__+"|"+b);P[c]=d;J[c]=
f};return a}var e={},M,p=null,D={error:!0},w="",i={},P={},J={},z={},x="",A={},B={},h=null,m={},s={},q={},l={},fa={},L="",F,S=$("head").get(0),E=!0,t,H=!1,O=!1,C={"en-US":{dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"January February March April May June July August September October November December".split(" "),dateFormat:"m/d/Y h:i:s",currency:{formatPos:"n",formatNeg:"(n)",decimal:".",thousand:",",precision:2}},"es-ES":{dayNames:"Domingo Lunes Martes Mi\u00e9rcoles Jueves Viernes S\u00e1bado".split(" "),
monthNames:"Enero Febrero Marzo Abril Mayo Junio Julio Agosto Septiembre Octubre Noviembre Diciembre".split(" "),dateFormat:"d/m/Y H:i:s",currency:{formatPos:"n",formatNeg:"-n",decimal:",",thousand:".",precision:2}}};e.screen={};e.event={};e.config={};e.ui={};e.net={};e.global={};e.local={};e.lang={};e.util={};e.config.Load=function(a){if(a){$.extend(m,a);U(m.global);a=G();if(m.log)for(var b=m.log[a].split(","),c=0;c<b.length;c++)D[$.trim(b[c])]=!0;E=!0;if(m.hasOwnProperty("environments-nocache"))for(var b=
m["environments-nocache"].split(","),c=0,d=b.length;c<d;c++)if(b[c]===a){E=!1;break}V(m.local)}return m};e.config.Env=G;e.global.Load=U;e.global.Data=function(a,b){if(a&&void 0!==b)A[a]=b;else return a?A[a]:A};e.local.Load=V;e.local.Data=function(a,b){if(a&&void 0!==b)B[a][G()]=b;else return a?B[a][G()]:B};e.lang.Load=Y;e.lang.LoadFrom=function(a,b,c){v("[iris.lang.LoadFrom]",a,b);R(b,"json",function(b){Y(a,b);v("[iris.lang.LoadFrom] loaded",b);c&&c.hasOwnProperty("success")&&c.success(a)},function(d){r(d.status,
"Error loading lang file",b);c&&c.hasOwnProperty("error")&&c.error(a)})};e.lang.Get=T;e.lang.Locale=function(a){if(void 0!==a)h=a;else return h};e.L=function(){t&&window.console.log&&window.console.log(w,arguments)};e.D=v;e.W=function(){t&&D.warning&&window.console.warn(w,arguments)};e.E=r;e.event.BEFORE_NAVIGATION="iris_before_navigation";e.event.Subscribe=function(a,b){q[a]||(q[a]=[]);var c=W(a,b);-1===c&&(c=q[a].length);q[a][c]=b};e.event.Notify=function(a,b){if(q[a])for(var c=q[a],d=0,f=c.length;d<
f;d++)c[d](b)};e.event.Remove=function(a,b){var c=W(a,b);-1!==c&&q[a].splice(c,1)};e.net.BaseUri=Q;e.net.Ajax=function(a){return $.ajax(a)};e.net.CacheVersion=function(a){M=a};e.Screen=function(a){a.prototype=K();l[F]=a};e.UI=function(a){l[F]=a};e.screen.WelcomeScreen=function(a){y(a);var b=K();b.prototype=l[a](b);b.__Id__="welcome-screen";b.__UIComponents__=[];b.__$Container__=$(document.body);b.__FileJs__=a;b.Create();b.__Awake__();b.Show();O=!0;"onhashchange"in window?(document.location.hash&&
N(),$(window).bind("hashchange",N)):r("The browser doesn't support the hashchange event")};e.screen.Destroy=function(a){if(i.hasOwnProperty(a)){var b=i[a].$Get().parent().data("screen_context");z[b]===i[a]&&delete z[b];i[a].__Destroy__();i[a].$Get().remove();delete i[a]}else iris.W('Error removing the screen "'+a+'", path not found.')};e.ui.JqToHash=Z;e.ui.HashToJq=function(a,b,c){var d=b.get(0);if(c)for(var f,e=0,g=c.length;e<g;e++)(f=a[c[e]])&&d.setAttribute(c[e],f);else for(f in a)a.hasOwnProperty(f)&&
d.setAttribute(f,a[f]);return b};e.Include=function(){for(var a=0,b=arguments.length;a<b;a++)y(arguments[a])};e.util.DateFormat=ca;e.util.Currency=aa;e.util.Deserialize=function(a,b){var c,d,f,e;for(e in b)if(b.hasOwnProperty(e)&&(c=a.find('[name="'+e+'"]'),0<c.length))switch(d=c[0].tagName.toLowerCase(),f=b[e],d){case "select":case "textarea":$(c).val(f);break;case "input":switch(d){case "checkbox":f&&c.attr("checked","checked");break;case "radio":c.filter('[value="'+f+'"]').attr("checked","checked");
break;default:c.val(f)}}};e.util.Serialize=function(a){var b={};$.map(a.serializeArray(),function(a){b[a.name]=a.value});return b};e.Goto=function(a){x=document.location.hash;document.location.hash=a};e.AddOn=function(a){fa[F]=a};e.ApplyAddOn=function(a,b,c){y(a);var d=da();d.__Components__=null;d.AddAll=function(a){for(var b=0,c=a.length;b<c;b++)d.Add(a[b])};d.Add=function(a){d.hasOwnProperty("UIAddOn")&&(a.proptotype=d.UIAddOn(a));d.__Components__[d.__Components__.length]=a};d.Remove=function(a){for(var b,
c=0,e=d.__Components__.length;c<e;c++)b=d.__Components__[c],b===a&&d.__Components__.splice(c,1)};d.Get=function(a){return d.__Components__[a]};d.Size=function(){return d.__Components__.length};d.Create=function(){};d.__Components__=[];d.__Setting__={};d.prototype=fa[a](d);d.Settings(c);d.AddAll(b);d.Create();return d};e.Regional=function(a,b){!b.hasOwnProperty("dayNames")||!b.hasOwnProperty("monthNames")||!b.hasOwnProperty("dateFormat")||!b.hasOwnProperty("currency")||!b.currency.hasOwnProperty("formatPos")||
!b.currency.hasOwnProperty("formatNeg")||!b.currency.hasOwnProperty("decimal")||!b.currency.hasOwnProperty("thousand")||!b.currency.hasOwnProperty("precision")?iris.E("Regional '"+a+"' has invalid format ",b):C[a]=b};"undefined"===typeof jQuery?r("jQuery 1.5+ previous load required"):1.5>$().jquery&&r("jQuery "+$().jquery+" currently loaded, jQuery 1.5+ required");t=window.console&&window.console.debug&&window.console.warn&&window.console.error;!t&&(window.console&&window.console.log)&&window.console.log("advanced console debugging is not supported in this browser");
return e}();